<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inside the Mind of an NFL Quarterback</title>
    <link rel="stylesheet" href="scroll-styles.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <!-- Navigation Progress Bar -->
    <div class="scroll-progress"></div>
    
    <!-- Section 1: HOOK -->
    <section class="story-section hook-section" id="hook">
        <div class="section-content">
            <h1 class="hook-question">How Hard is it Really to Play Quarterback in the NFL?</h1>
            
            <div class="split-screen">
                <div class="couch-view">
                    <div class="view-label">From our couch, we usually say:</div>
                    <div class="view-label">"This QB sucks. He can't make a throw."</div>
                </div>
                
                <div class="reality-view">
                    <div class="view-label">The reality:</div>
                    <div class="view-label">Being a QB is one of the most difficult positions in all of sports.</div>
                </div>
            </div>
            <div class="football-animation-container">
                <svg id="football-animation-svg" width="100%" height="100"></svg>
            </div>
        </div>
    </section>
    
    <!-- Section 2: Broadcast Comparison -->
    <section class="story-section broadcast-section" id="broadcast">
        <div class="section-content">
            <h1 class="section-title">What The Broadcast Doesn't Show</h1>
            
            <div class="broadcast-comparison">
                <div class="broadcast-image-container">
                    <img src="nfl_broadcast_example.webp" alt="NFL Broadcast View" class="broadcast-image">
                    <div class="annotations-container" id="broadcast-annotations"></div>
                </div>
                
                <div class="broadcast-text">
                    <div class="comparison-point" data-animate="fadeInLeft">
                        <h3>‚ùå Missing: Full Field View</h3>
                        <p>The broadcast angle only shows the quarterback and not the full field or the timing of route breaks.</p>
                    </div>
                    
                    <div class="comparison-point" data-animate="fadeInLeft">
                        <h3>‚ùå Missing: Real-Time Separation</h3>
                        <p>We can never truly see how open each receiver was unless the broadcast specifically shows it.</p>
                    </div>
                    
                    <div class="comparison-point" data-animate="fadeInLeft">
                        <h3>‚ùå Missing: Defensive Scheme</h3>
                        <p>We can't see the defensive coverage schemes and how they change over the course of the play.</p>
                    </div>
                    
                    <div class="comparison-point highlight" data-animate="fadeInLeft">
                        <h3><strong>The Broadcast is Chaotic</strong></h3>
                        <p>What we think we see on TV is nothing like the decision environment a quarterback actually faces.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Section 3: Our Solution -->
    <section class="story-section solution-section" id="solution">
        <div class="section-content">
            <h1 class="section-title">Seeing What the Quarterback Sees</h1>
            
            <div class="solution-content">
                <div class="solution-text">
                    <h2>Full Field View</h2>
                    <p class="lead-solution">
                        Our visualization solves this gap. It lets viewers experience the play from a true birds-eye perspective 
                        and understand what the quarterback is seeing in real time, something the broadcast simply cannot show.
                    </p>
                    
                    <div class="solution-features">
                        <div class="feature-item" data-animate="fadeInUp">
                            <div class="feature-icon">üëÅÔ∏è</div>
                            <h3>Birds-Eye Perspective</h3>
                            <p>See the entire field, not just the quarterback</p>
                        </div>
                        
                        <div class="feature-item" data-animate="fadeInUp">
                            <div class="feature-icon">‚è±Ô∏è</div>
                            <h3>Real-Time Understanding</h3>
                            <p>Frame-by-frame tracking of every player</p>
                        </div>
                        
                        <div class="feature-item" data-animate="fadeInUp">
                            <div class="feature-icon">üìä</div>
                            <h3>Beyond Static Charts</h3>
                            <p>Experience the process, not just outcomes</p>
                        </div>
                    </div>
                </div>
                
                <div class="solution-preview" data-animate="fadeInRight">
                    <div class="preview-field">
                        <svg id="solution-preview-svg" width="500" height="300"></svg>
                    </div>
                    <div class="preview-legend">
                        <div class="legend-item">
                            <span class="legend-color offense"></span>
                            <span>Offensive Player</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color defense"></span>
                            <span>Defensive Player</span>
                        </div>
                    </div>
                    <p class="preview-label">Preview: Interactive Field View</p>
                </div>
            </div>
        </div>
    </section>
    
    
    <!-- Section 4: Tutorial - Frame Tracking -->
    <section class="story-section tutorial-section" id="tutorial-tracking">
        <div class="section-content">
            <h1 class="section-title">Every Player, Frame by Frame</h1>
            <p class="tutorial-intro">As the play unfolds, every receiver and every defender is tracked.</p>
            
            <div class="tutorial-demo">
                <div class="frame-tracking-demo">
                    <svg id="tracking-svg" width="800" height="450"></svg>
                    <div class="annotations-overlay" id="tracking-annotations"></div>
                </div>
                
                <div class="tutorial-explanation" data-animate="fadeInUp">
                    <h3>Real-Time Separation</h3>
                    <p>The spacing between each pair updates frame-by-frame, showing who is open at each moment. 
                    This is the critical information a quarterback processes in real-time, but you can anaylze it at your own pace.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 5: Tutorial - Decision Comparison -->
    <section class="story-section tutorial-section" id="tutorial-decision">
        <div class="section-content">
            <h1 class="section-title">Actual vs. Optimal</h1>
            <p class="tutorial-intro">Is there a way to objectively measure the quality of a quarterback's decision?</p>
            
            <div class="tutorial-demo">
                <div class="decision-demo">
                    <svg id="decision-svg" width="800" height="450"></svg>
                    <div class="annotations-overlay" id="decision-annotations"></div>
                </div>
                
                <div class="tutorial-explanation" data-animate="fadeInUp">
                    <h3>Decision Quality</h3>
                    <p>We developed a catch probability model - based on the receiver's speed, separation from defender, and the proximity of other defenders
                         - to have a continious measure of how likely each reciever is to catch the ball at different windows of time. Using this model, we can then compare the actual decision of the quarterback to the objectively optimal decision.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 5.5: Model in Action -->
    <section class="story-section tutorial-section" id="tutorial-model-demo">
        <div class="section-content">
            <h1 class="section-title">Let's see the model in action</h1>
            <p class="tutorial-intro">Watch how catch probability, target probability, and expected yards evolve frame-by-frame for each receiver.</p>
            
            <div class="tutorial-demo">
                <div class="model-demo-container">
                    <div id="model-demo-visualization"></div>
                    <div class="model-demo-controls">
                        <button id="model-demo-play-pause-btn">Play</button>
                        <button id="model-demo-reset-btn">Reset</button>
                        <input type="range" id="model-demo-frame-slider" min="1" max="26" value="1" step="1">
                        <div class="frame-display" id="model-demo-frame-display">Frame: 1 / 26</div>
                    </div>
                    
                    <!-- Stat selector -->
                    <div class="model-demo-stat-selector">
                        <label>Stat to Display:</label>
                        <label><input type="radio" name="model-demo-stat" value="catch_probability" checked> Catch Probability</label>
                        <label><input type="radio" name="model-demo-stat" value="expected_yards"> Expected Yds</label>
                        <label><input type="radio" name="model-demo-stat" value="target_probability"> Target Probability</label>
                    </div>
                </div>
                
                <div class="tutorial-explanation" data-animate="fadeInUp">
                    <h3>Real-Time Predictions</h3>
                    <p>As receivers run their routes, our model continuously updates predictions for each receiver. Watch how catch probability, target probability, and expected yards change as the play develops. The optimal receiver is the one with the highest expected yards at any given moment.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 5.6: QB Optimal Decision Analysis -->
    <section class="story-section tutorial-section" id="qb-optimal-analysis">
        <div class="section-content">
            <h1 class="section-title">How Often Do QBs Make the Optimal Decision?</h1>
            <p class="tutorial-intro">We analyzed every passing play from Week 1 of the 2023 NFL season to see how often quarterbacks chose the receiver with the highest expected yards‚Äîthe objectively optimal decision according to our model. </p>
            
            <div class="qb-analysis-container">
                <div class="qb-analysis-stats">
                    <div class="overall-stat">
                        <div class="stat-number" id="overall-optimal-pct">--</div>
                        <div class="stat-label">of all throws were optimal</div>
                    </div>
                    <div class="stat-breakdown">
                        <span id="optimal-plays">--</span> optimal decisions out of <span id="total-plays">--</span> total plays
                    </div>
                </div>
                
                <div class="qb-analysis-viz" id="qb-optimal-viz">
                    <!-- Visualization will be rendered here -->
                </div>
                
                <div class="qb-analysis-explanation" data-animate="fadeInUp">
                    <h3>What This Means</h3>
                    <p>Even the best quarterbacks in the NFL don't always make the optimal decision. Factors like pressure, timing, trust in receivers, and defensive schemes all influence their choices. The top performers highlighted above made the optimal decision more than 60% of the time, showing just how difficult it is to consistently make the "right" read.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 5.7: Time to Throw Analysis -->
    <section class="story-section tutorial-section" id="time-to-throw-analysis">
        <div class="section-content">
            <h1 class="section-title">How Fast Do QBs Make Throwing Decisions?</h1>
            <p class="tutorial-intro">Time to throw measures how quickly a quarterback releases the ball after the snap. <br>Let's look at each QB from 2023 Week 1 and see how fast, on average, they make throwing decisions.</p>
            
            <div class="time-to-throw-container">
                <div class="time-to-throw-comparison">
                    <div class="time-stat-card overall-time">
                        <div class="time-stat-label">Overall Average</div>
                        <div class="time-stat-value" id="overall-time-value">--</div>
                        <div class="time-stat-subtitle">All Week 1 Plays</div>
                        <div class="time-stat-count" id="overall-time-count">-- plays</div>
                    </div>
                    
                    <div class="time-stat-card non-optimal-time">
                        <div class="time-stat-label">Non-Optimal Decisions</div>
                        <div class="time-stat-value" id="non-optimal-time-value">--</div>
                        <div class="time-stat-subtitle">When QB Made Suboptimal Choice</div>
                        <div class="time-stat-count" id="non-optimal-time-count">-- plays</div>
                    </div>
                    
                    <div class="time-stat-card optimal-time">
                        <div class="time-stat-label">Optimal Decisions</div>
                        <div class="time-stat-value" id="optimal-time-value">--</div>
                        <div class="time-stat-subtitle">When QB Made Optimal Choice</div>
                        <div class="time-stat-count" id="optimal-time-count">-- plays</div>
                    </div>
                </div>
                
                <div class="time-to-throw-viz" id="time-to-throw-viz">
                    <!-- Visualization will be rendered here -->
                </div>
                
            </div>
        </div>
    </section>

    
    <!-- Section 6: Quarterback Challenge -->
    <section class="story-section tutorial-section" id="tutorial-randomize">
        <div class="section-content">
            <div class="qb-container">
                <div class="qb-header">
                    <h1>Your Turn! See how you stack up against NFL's best.</h1>
                    <p class="subtitle">We filtered plays in which the QB made the optimal decision. Try to guess which reciever the QB threw to!</p>
                </div>
                
                <!-- Top section with stats and scoreboard -->
                <div class="top-section">
                    <div class="qb-stats">
                        <div class="stat-item">
                            <div class="stat-label">Correct</div>
                            <div class="stat-value" id="qb-correct-count">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Attempts</div>
                            <div class="stat-value" id="qb-total-count">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Accuracy</div>
                            <div class="stat-value" id="qb-accuracy-pct">--%</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">AVG TIME</div>
                            <div class="stat-value" id="qb-avg-time">--</div>
                        </div>
                    </div>
                    
                    <div class="qb-scoreboard" id="qb-scoreboard">
                        <div class="team-score" id="qb-visitor-section">
                            <span class="team-name" id="qb-visitor-name">--</span>
                            <span class="score" id="qb-visitor-score">0</span>
                        </div>
                        <div class="game-situation">
                            <div class="down-distance" id="qb-down-distance">-- & --</div>
                            <div class="quarter-clock" id="qb-quarter-clock">Q- 0:00</div>
                            <div class="yardline-info" id="qb-yardline-info">Ball on --</div>
                            <div class="hidden-info">
                                <span id="qb-game-id">-</span>
                                <span id="qb-play-id">-</span>
                                <span id="qb-play-direction">-</span>
                            </div>
                        </div>
                        <div class="team-score" id="qb-home-section">
                            <span class="score" id="qb-home-score">0</span>
                            <span class="team-name" id="qb-home-name">--</span>
                        </div>
                    </div>
                </div>
                
                <!-- Main layout: field + side panel -->
                <div class="main-layout">
                    <div class="field-section">
                        <div class="field-wrapper">
                            <!-- Coverage info - prominent -->
                            <div class="coverage-bar">
                                <div class="coverage-label">Defensive Coverage</div>
                                <div class="coverage-type" id="qb-coverage-annotation">Loading...</div>
                            </div>
                            
                            <div id="qb-visualization"></div>
                            
                            <!-- Coverage description -->
                            <div class="coverage-description" id="qb-coverage-description">
                                <h4>Coverage Explanation</h4>
                                <p id="qb-coverage-explanation">Watch the defense to identify their coverage scheme.</p>
                            </div>
                            
                            <div class="legend">
                                <div class="legend-item">
                                    <span class="legend-color defense"></span>
                                    <span>Defense</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color offense"></span>
                                    <span>Offense</span>
                                </div>
                                <div class="legend-item">
                                    <span style="font-size: 16px;">üèà</span>
                                    <span>Quarterback</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color" style="background: #f39c12; border: 2px dashed #333;"></span>
                                    <span>Selected</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="side-panel">
                        <!-- Controls -->
                        <div class="control-box">
                            <h3>üéÆ Controls</h3>
                            <div class="control-buttons">
                                <button id="qb-randomize-btn">Next Play</button>
                                <button id="qb-play-pause-btn">Play</button>
                                <button id="qb-reset-btn">Reset</button>
                            </div>
                            <div class="stopwatch-display" id="qb-stopwatch" style="display: none;">0.0s</div>
                            <div class="slider-container">
                                <input type="range" id="qb-frame-slider" min="1" max="26" value="1" step="1">
                                <div class="frame-display" id="qb-frame-display">Frame: 1 / 26</div>
                            </div>
                            <div class="toggle-options">
                                <label>
                                    <input type="checkbox" id="qb-show-trails" checked> Show Trails
                                </label>
                                <label>
                                    <input type="checkbox" id="qb-show-names" checked> Show Names
                                </label>
                            </div>
                        </div>
                        
                        <!-- Instructions -->
                        <div class="instruction-box" id="qb-instruction-text">
                            <p>üé¨ Press <strong>Play</strong> to start!</p>
                            <p style="font-size: 0.85em; margin-top: 5px; color: #666;">Watch the routes develop, then pick your target.</p>
                        </div>
                        
                        <!-- Receiver Selection -->
                        <div class="receiver-box" id="qb-receiver-selection">
                            <h3>üéØ Pick Your Target</h3>
                            <div class="receiver-buttons" id="qb-receiver-buttons">
                                <!-- Receiver buttons added dynamically -->
                            </div>
                        </div>
                        
                        <!-- Result Panel -->
                        <div class="result-box" id="qb-result-panel">
                            <div class="result-title" id="qb-result-title"></div>
                            <div class="result-message" id="qb-result-message"></div>
                            <div class="actual-target">Target: <span id="qb-actual-target"></span></div>
                            <div class="play-outcome" id="qb-play-outcome"></div>
                        </div>
                    </div>
                </div>
                
                <!-- How to play -->
                <div class="how-to-play">
                    <h2>How to Play</h2>
                    <ol>
                        <li><strong>Press Play</strong> - Watch the receivers run their routes and the defense react.</li>
                        <li><strong>Make Your Read</strong> - When it pauses, pick who you would throw to!</li>
                        <li><strong>Click a Receiver</strong> - Your choice is immediately confirmed. See if you made the same read as the NFL quarterback.</li>
                    </ol>
                    <p style="margin-top: 15px;"><strong>Tips:</strong> Analyze the coverage, look for separation, and look at player trails to make your decision!</p>
                </div>
            </div>
            
            <!-- Hidden time-to-throw element for JS compatibility -->
            <div id="qb-time-to-throw" style="display:none;"></div>
        </div>
    </section>

    <!-- Section 7: NFL Comparison -->
    <section class="story-section tutorial-section" id="nfl-comparison">
        <div class="section-content">
            <h1 class="section-title">How Did You Stack Up Against NFL Quarterbacks?</h1>
            <p class="tutorial-intro">After playing Quarterback Mode, see how your accuracy and decision speed compare to NFL Week 1 averages.</p>
            
            <div class="nfl-comparison-container">
                <div class="nfl-comparison-stats" id="nfl-comparison-stats">
                    <div class="comparison-stat-card">
                        <div class="comparison-stat-header">
                            <h3>Accuracy</h3>
                            <p class="stat-description">Optimal Decision Percentage</p>
                        </div>
                        <div class="comparison-values-large">
                            <div class="comparison-value user-comparison">
                                <div class="value-label">You</div>
                                <div class="value-number" id="user-accuracy">--%</div>
                            </div>
                            <div class="comparison-vs">vs</div>
                            <div class="comparison-value nfl-comparison">
                                <div class="value-label">NFL Week 1 Avg</div>
                                <div class="value-number" id="nfl-accuracy">46.98%</div>
                            </div>
                        </div>
                        <div class="comparison-diff-large" id="accuracy-diff">Make at least one decision to see your comparison</div>
                    </div>
                    
                    <div class="comparison-stat-card">
                        <div class="comparison-stat-header">
                            <h3>Speed</h3>
                            <p class="stat-description">Average Time to Throw</p>
                        </div>
                        <div class="comparison-values-large">
                            <div class="comparison-value user-comparison">
                                <div class="value-label">You</div>
                                <div class="value-number" id="user-time">--s</div>
                            </div>
                            <div class="comparison-vs">vs</div>
                            <div class="comparison-value nfl-comparison">
                                <div class="value-label">NFL Week 1 Avg</div>
                                <div class="value-number" id="nfl-time">2.66s</div>
                            </div>
                        </div>
                        <div class="comparison-diff-large" id="time-diff">Make at least one decision to see your comparison</div>
                    </div>
                </div>
                
                <div class="nfl-comparison-message" id="nfl-comparison-message" style="display: none;">
                    <p>Play Quarterback Mode above to see how you compare!</p>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Section 10.5: Context & Transition to Sandbox -->
    <section class="story-section" id="context-transition">
        <div class="section-content">
            <div class="context-wrapper">
                <h2 class="context-title">But Remember...</h2>
                <p class="context-text">
                    These comparisons don't factor in the real-world challenges that NFL quarterbacks face every play:
                </p>
                <ul class="context-list">
                    <li><strong>Defensive pressure:</strong> 300-pound linemen trying to sack you</li>
                    <li><strong>Stadium noise:</strong> 70,000+ fans screaming in your ears</li>
                    <li><strong>Game pressure:</strong> The weight of millions watching, playoff implications, career-defining moments</li>
                    <li><strong>Limited vision:</strong> Helmets, facemasks, and bodies blocking your view</li>
                    <li><strong>Physical demands:</strong> Running for your life while trying to make split-second decisions</li>
                    <li><strong>Mental fatigue:</strong> Processing complex defensive schemes while exhausted</li>
                </ul>
                <p class="context-conclusion">
                    What you've experienced is just a glimpse into the quarterback's world‚Äîthe decision-making, the timing, the precision required. But in reality, these athletes perform under conditions we can barely imagine.
                </p>
            </div>
        </div>
    </section>
    
    <!-- Section 11: Interactive Sandbox -->
    <section class="story-section interactive-section" id="interactive">
        <div class="section-content">
            <h1 class="section-title">Interactive Play Analysis</h1>
            <p class="slide-description">Explore frame-by-frame how a quarterback makes decisions under pressure</p>
            <p class="sandbox-intro">This is your sandbox. Explore freely, randomize plays, and experience what a quarterback sees in real-time.</p>
            
            <div class="container">
                <div class="info">
                    <p><strong>Game ID:</strong> 2023090700 | <strong>Play ID:</strong> 101 | <strong>Direction:</strong> <span id="play-direction">-</span></p>
                </div>
                
                <div class="controls">
                    <button id="randomize-btn" style="background: #9C27B0; color: white;">Randomize Play</button>
                    <button id="play-pause-btn">Play</button>
                    <button id="reset-btn">Reset</button>
                    <input type="range" id="frame-slider" min="1" max="26" value="1" step="1">
                    <span id="frame-display">Frame: 1 / 26</span>
                    <label>
                        <input type="checkbox" id="show-trails" checked> Show Trails
                    </label>
                    <label>
                        <input type="checkbox" id="show-names" checked> Show Names
                    </label>
                    <label>
                        <input type="checkbox" id="show-ball-trajectory" checked> Show Ball Trajectory
                    </label>
                    <label>
                        <input type="checkbox" id="show-output-players" checked> Show Post-Throw Players
                    </label>
                </div>
                
                <div id="scoreboard" class="scoreboard"></div>
                
                <div class="main-content">
                    <div class="visualization-container">
                        <div class="top-info-bar">
                            <div id="time-to-throw" class="time-to-throw">Time to Throw: 0.0s</div>
                            <div id="coverage-annotation" class="coverage-annotation"></div>
                        </div>
                        <div id="visualization"></div>
                        <div id="play-description" class="play-description"></div>
                    </div>
                    <div id="supplementary-panel" class="supplementary-panel"></div>
                </div>
                
                <div class="legend">
                    <div class="legend-item">
                        <span class="legend-color defense"></span>
                        <span>Defense</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color offense"></span>
                        <span>Offense</span>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Navigation Instructions -->
    <div class="navigation-instructions">
        <div class="nav-key-hint">
            <span class="key-icon">‚Üë</span>
            <span class="key-label">up arrow</span>
            <span class="key-separator">|</span>
            <span class="key-icon">‚Üì</span>
            <span class="key-label">down arrow</span>
        </div>
        <p class="nav-instruction-text">use arrow keys to navigate</p>
    </div>
    
    <script src="visualization.js"></script>
    <script src="scroll-animations.js"></script>
    <script src="qb_simulate.js"></script>
</body>
</html>

